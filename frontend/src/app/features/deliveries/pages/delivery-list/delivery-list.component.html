<div class="p-6">
  <h1 class="text-2xl font-bold mb-6">Gestion des Livraisons</h1>

  <!-- Filters -->
  <div class="bg-white p-4 rounded shadow mb-6">
    <h2 class="text-lg font-semibold mb-4">Filtres</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium mb-1">Recherche</label>
        <input 
          type="text" 
          [(ngModel)]="searchForm.searchTerm"
          class="w-full px-3 py-2 border rounded"
          placeholder="Numéro de suivi, nom, téléphone...">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Statut</label>
        <select [(ngModel)]="searchForm.status" class="w-full px-3 py-2 border rounded">
          <option [value]="undefined">Tous</option>
          <option *ngFor="let status of statusOptions" [value]="status">
            {{getStatusLabel(status)}}
          </option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Priorité</label>
        <select [(ngModel)]="searchForm.priority" class="w-full px-3 py-2 border rounded">
          <option [value]="undefined">Toutes</option>
          <option *ngFor="let priority of priorityOptions" [value]="priority">
            {{getPriorityLabel(priority)}}
          </option>
        </select>
      </div>
    </div>
    <div class="mt-4 flex gap-2">
      <button (click)="onSearch()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        Rechercher
      </button>
      <button (click)="onReset()" class="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400">
        Réinitialiser
      </button>
    </div>
  </div>

  <div *ngIf="error()" class="bg-red-100 text-red-700 p-3 rounded mb-4">{{error()}}</div>

  <div *ngIf="loading()" class="text-center py-8">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
  </div>

  <!-- Table -->
  <div *ngIf="!loading()" class="bg-white rounded shadow overflow-hidden">
    <table class="min-w-full">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Numéro</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Description</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Expéditeur</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Destinataire</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Statut</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Priorité</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <tr *ngFor="let d of deliveries()" class="hover:bg-gray-50">
          <td class="px-6 py-4 text-sm font-mono">{{d.trackingNumber}}</td>
          <td class="px-6 py-4 text-sm">{{d.description}}</td>
          <td class="px-6 py-4 text-sm">{{d.senderName}}</td>
          <td class="px-6 py-4 text-sm">{{d.recipientName}}</td>
          <td class="px-6 py-4">
            <span [class]="'px-2 py-1 rounded text-xs ' + getStatusClass(d.status)">
              {{getStatusLabel(d.status)}}
            </span>
          </td>
          <td class="px-6 py-4">
            <span [class]="'px-2 py-1 rounded text-xs ' + getPriorityClass(d.priority)">
              {{getPriorityLabel(d.priority)}}
            </span>
          </td>
          <td class="px-6 py-4 text-sm">{{formatDate(d.createdAt)}}</td>
          <td class="px-6 py-4 text-sm">
            <button (click)="viewDetails(d.id)" class="text-blue-600 hover:text-blue-800">
              Détails
            </button>
          </td>
        </tr>
        <tr *ngIf="deliveries().length === 0">
          <td colspan="8" class="px-6 py-4 text-center text-gray-500">
            Aucune livraison
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div *ngIf="!loading() && totalPages() > 1" class="mt-4 flex justify-between items-center">
    <div class="text-sm text-gray-700">
      Page {{currentPage() + 1}} / {{totalPages()}} ({{totalElements()}} livraisons)
    </div>
    <div class="flex gap-2">
      <button 
        (click)="onPageChange(currentPage() - 1)" 
        [disabled]="currentPage() === 0"
        class="px-4 py-2 border rounded disabled:bg-gray-100 disabled:text-gray-400 hover:bg-gray-50">
        Précédent
      </button>
      <button 
        (click)="onPageChange(currentPage() + 1)" 
        [disabled]="currentPage() >= totalPages() - 1"
        class="px-4 py-2 border rounded disabled:bg-gray-100 disabled:text-gray-400 hover:bg-gray-50">
        Suivant
      </button>
    </div>
  </div>
</div>